"use strict";angular.module("fuelCalculator",["ngRoute"]).config(["$routeProvider",function(e){e.when("/comparison",{templateUrl:"views/comparison.html",controller:"ComparisonCtrl",controllerAs:"vm"}).when("/cost",{templateUrl:"views/cost.html",controller:"CostCtrl",controllerAs:"vm"}).when("/distance",{templateUrl:"views/distance.html",controller:"DistanceCtrl",controllerAs:"vm"}).when("/fuel-volume",{templateUrl:"views/fuel-volume.html",controller:"FuelVolumeCtrl",controllerAs:"vm"}).when("/tank-volume",{templateUrl:"views/tank-volume.html",controller:"TankVolumeCtrl",controllerAs:"vm"}).otherwise({redirectTo:"/distance"})}]).run(["$rootScope","$location","$window",function(e,t,r){var n=null;e.$on("$routeChangeSuccess",function(e,c,i){var a=t.path();r.ga&&a!==n&&r.ga("send","pageview",{page:a}),n=a})}]),angular.module("fuelCalculator").service("settingsService",["$window",function(e){var t=this;this.fuelType=function(r){if(!r)return e.localStorage.getItem("fuelType")||"91";var n=t.fuelType();e.localStorage.setItem("fuelType",r),e.ga&&e.ga("send","event","Octane","change",n+"->"+r)},this.tankVolume=function(t){return t?void e.localStorage.setItem("tankVolume",parseFloat(t)||65):parseFloat(e.localStorage.getItem("tankVolume"))||65},this.consumption=function(t){return t?void e.localStorage.setItem("consumption",parseFloat(t)||8):parseFloat(e.localStorage.getItem("consumption"))||8},this.alertsRead=function(t){return t?void e.localStorage.setItem("alertsRead",!!t):!!e.localStorage.getItem("alertsRead")}}]),angular.module("fuelCalculator").service("menuService",["$window","periodService","priceService","settingsService",function(e,t,r,n){function c(t,r){var n=r||null;return{getSelected:function(){return n},isSelected:function(e){return e===n},select:function(r){var c=n;n=r,e.ga&&e.ga("send","event",t,"change",c+"->"+r)}}}this.getOctaneMenu=function(e,t){var r=c("New Octane",e||"91");if(r.getSelectedLabel=r.getSelected,!t){var i=r.select;r.select=function(e){n.fuelType(e),i(e)}}return r},this.getMeasureMenu=function(e){var t=c("Measure",e||"distance");return t.getSelectedLabel=function(){switch(t.getSelected()){case"distance":return"المسافة";case"cost":return"التكلفة"}},t},this.getPriceTypeMenu=function(e){var t=c("PriceType",e||"new");return t.getSelectedLabel=function(){return r.getPriceTypeLabel(t.getSelected())},t},this.getPeriodMenu=function(e){var r=c("Period",e||"day");return r.getSelectedLabel=function(){return t.getPeriodLabel(r.getSelected())},r.getValuePerDay=function(e){return t.getValuePerDay(r.getSelected(),e)},r}}]),angular.module("fuelCalculator").service("fuelService",function(){function e(e,t,r){return e/t*r}function t(e,t){return"new"===e?"91"===t?.75:.9:"91"===t?.45:.6}function r(e,r,n){var c=t(e,r),i=n/c;return i}function n(e,t,n,c,i){var a=r(e,t,i),u=a*n/c;return u}function c(e,r,n){return n*t(e,r)}function i(e,t,r,n,i){var a=n/r,u=a*i;return c(e,t,u)}this.roundPrice=function(e){return 10>e?e:Math.round(e)},this.whichBetter=function(e,r,n,c,i){var a=t(e,r)/n,u=t(e,c)/i;return u>a?"first":a>u?"second":"same"},this.calculateByDistance=i,this.calculateByVolume=c,this.calculateDistanceByVolume=e,this.calculateDistanceByPrice=n,this.getLiterPrice=t}),angular.module("fuelCalculator").service("periodService",["$window",function(e){var t="يوم",r="اسبوع",n="شهر",c="سنة",i=[[t,1],[r,7],[n,30],[c,360]],a="اليوم",u="الاسبوع",l="الشهر",o="السنة",s={day:1,week:7,month:30,year:360},d={day:a,week:u,month:l,year:o};this.getPeriodLabel=function(e){return d[e]},this.getValuePerDay=function(e,t){return t/s[e]},this.getPeriodTable=function(){return i}}]),angular.module("fuelCalculator").service("priceService",[function(){var e="حالياً",t="سابقاً";this.getPriceTypeLabel=function(r){return"new"===r?e:t}}]),angular.module("fuelCalculator").filter("roundPrice",["$filter","fuelService",function(e,t){var r=e("number");return function(e,n){return 10>e?r(e,n):r(t.roundPrice(e),0)}}]),angular.module("fuelCalculator").controller("FuelVolumeCtrl",["fuelService","menuService","periodService","settingsService",function(e,t,r,n){var c=this;this.periodTable=r.getPeriodTable(),this.periodMenu=t.getPeriodMenu(),this.octaneMenu=t.getOctaneMenu(n.fuelType()),this.volume=1,this.calculatePrice=function(t,r){var n=c.periodMenu.getValuePerDay(c.volume)*r,i=c.octaneMenu.getSelected();return e.calculateByVolume(t,i,n)},this.calculatePriceDifference=function(t){var r=c.calculatePrice("old",t),n=c.calculatePrice("new",t);return e.roundPrice(n)-e.roundPrice(r)}}]),angular.module("fuelCalculator").controller("TankVolumeCtrl",["fuelService","menuService","periodService","settingsService",function(e,t,r,n){var c=this;this.distanceForLiters=n.consumption(),this.tankVolume=n.tankVolume(),this.litersForDistance=1,this.fillTimes=1,this.periodTable=r.getPeriodTable(),this.periodMenu=t.getPeriodMenu("week"),this.updateTankVolume=n.tankVolume,this.setConsumption=n.consumption,this.calculateDistance=function(t){var r=c.periodMenu.getValuePerDay(c.fillTimes)*t,n=c.tankVolume*r;return e.calculateDistanceByVolume(c.distanceForLiters,c.litersForDistance,n)},this.calculatePrice=function(t,r){var i=c.calculateDistance(r),a=n.fuelType();return e.calculateByDistance(t,a,c.distanceForLiters,c.litersForDistance,i)},this.calculatePriceDifference=function(t){var r=c.calculatePrice("old",t),n=c.calculatePrice("new",t);return e.roundPrice(n)-e.roundPrice(r)}}]),angular.module("fuelCalculator").controller("DistanceCtrl",["fuelService","menuService","periodService","settingsService",function(e,t,r,n){var c=this;this.litersForDistance=1,this.distance=15,this.distanceForLiters=n.consumption(),this.setConsumption=n.consumption,this.periodTable=r.getPeriodTable(),this.periodMenu=t.getPeriodMenu(),this.calculateDistance=function(e){var t=c.periodMenu.getValuePerDay(c.distance);return t*e},this.calculatePrice=function(t,r){var i=c.periodMenu.getValuePerDay(c.distance)*r,a=n.fuelType();return e.calculateByDistance(t,a,c.distanceForLiters,c.litersForDistance,i)},this.calculatePriceDifference=function(t){var r=c.calculatePrice("old",t),n=c.calculatePrice("new",t);return e.roundPrice(n)-e.roundPrice(r)}}]),angular.module("fuelCalculator").controller("CostCtrl",["fuelService","menuService","periodService","settingsService",function(e,t,r,n){var c=this;this.litersForDistance=1,this.cost=1,this.distanceForLiters=n.consumption(),this.setConsumption=n.consumption,this.periodTable=r.getPeriodTable(),this.periodMenu=t.getPeriodMenu(),this.priceMenu=t.getPriceTypeMenu(),this.calculateDistance=function(t){var r=c.periodMenu.getValuePerDay(c.cost)*t,i=c.priceMenu.getSelected(),a=n.fuelType();return e.calculateDistanceByPrice(i,a,c.distanceForLiters,c.litersForDistance,r)},this.calculatePrice=function(t,r){var i=n.fuelType(),a=c.calculateDistance(r);return e.calculateByDistance(t,i,c.distanceForLiters,c.litersForDistance,a)},this.calculatePriceDifference=function(t){var r=c.calculatePrice("old",t),n=c.calculatePrice("new",t);return e.roundPrice(n)-e.roundPrice(r)}}]),angular.module("fuelCalculator").controller("ComparisonCtrl",["fuelService","menuService","periodService","settingsService",function(e,t,r,n){var c=this;this.litersForDistance=1,this.costOrDistance=15,this.distanceForLiters1=n.consumption(),this.distanceForLiters2=n.consumption(),this.periodTable=r.getPeriodTable(),this.periodMenu=t.getPeriodMenu(),this.measureMenu=t.getMeasureMenu(),this.octaneMenu1=t.getOctaneMenu(n.fuelType(),!0),this.octaneMenu2=t.getOctaneMenu(n.fuelType(),!0),this.getSelectedUnit=function(){switch(c.measureMenu.getSelected()){case"distance":return"كيلو";case"cost":return"ريال"}},this.whichBetter=function(){return e.whichBetter("new",c.octaneMenu1.getSelected(),c.distanceForLiters1,c.octaneMenu2.getSelected(),c.distanceForLiters2)},this.getFirstClass=function(){switch(c.whichBetter()){case"second":return"warning";case"first":case"same":return"success"}},this.getSecondClass=function(){switch(c.whichBetter()){case"first":return"warning";case"second":case"same":return"success"}},this.cost={},this.cost.calculateDistance=function(t,r,n){var i=c.periodMenu.getValuePerDay(c.costOrDistance)*n;return e.calculateDistanceByPrice("new",t,r,c.litersForDistance,i)},this.cost.calculatePrice=function(e){var t=c.periodMenu.getValuePerDay(c.costOrDistance);return t*e},this.cost.calculateDistanceDifference=function(t){var r=c.cost.calculateDistance(c.octaneMenu1.getSelected(),c.distanceForLiters1,t),n=c.cost.calculateDistance(c.octaneMenu2.getSelected(),c.distanceForLiters2,t);return Math.abs(e.roundPrice(n)-e.roundPrice(r))},this.distance={},this.distance.calculateDistance=function(e){var t=c.periodMenu.getValuePerDay(c.costOrDistance);return t*e},this.distance.calculatePrice=function(t,r,n){var i=c.periodMenu.getValuePerDay(c.costOrDistance)*n;return e.calculateByDistance("new",t,r,c.litersForDistance,i)},this.distance.calculatePriceDifference=function(t){var r=c.distance.calculatePrice(c.octaneMenu1.getSelected(),c.distanceForLiters1,t),n=c.distance.calculatePrice(c.octaneMenu2.getSelected(),c.distanceForLiters2,t);return Math.abs(e.roundPrice(n)-e.roundPrice(r))}}]),angular.module("fuelCalculator").controller("NavbarCtrl",["$location","settingsService",function(e,t){this.setFuelType=t.fuelType,this.isFuelType=function(e){return t.fuelType()===e},this.octaneHidden=function(){var t=e.path();return"/comparison"===t||"/fuel-volume"===t}}]),angular.module("fuelCalculator").controller("TabsCtrl",["$location",function(e){this.isCurrentPath=function(t){return t===e.path()}}]),angular.module("fuelCalculator").controller("AlertsCtrl",["settingsService",function(e){this.alertsRead=function(){return e.alertsRead()},this.dismiss=function(){e.alertsRead(!0)}}]);